<Window x:Class="StemSplitter.GUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="StemSplitter - Audio Stem Separator"
        Height="850" Width="900"
        MinHeight="700" MinWidth="700"
        Background="{StaticResource BackgroundBrush}"
        WindowStartupLocation="CenterScreen"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="ðŸŽµ StemSplitter"
                       FontSize="32"
                       FontWeight="Bold"
                       Foreground="{StaticResource PrimaryBrush}"/>
            <TextBlock Text="Extract individual instrument stems from audio files"
                       FontSize="14"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Margin="0,5,0,0"/>
        </StackPanel>

        <!-- File Selection -->
        <Border Grid.Row="1"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="8"
                Padding="20"
                Margin="0,0,0,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Input Audio File"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           FontSize="12"
                           Margin="0,0,0,5"/>

                <Border Grid.Row="1" Grid.Column="0"
                        Background="#1A1A1A"
                        CornerRadius="4"
                        Padding="12,10"
                        Margin="0,0,10,0"
                        BorderBrush="#404040"
                        BorderThickness="1"
                        x:Name="DropZone">
                    <TextBlock x:Name="InputFileText"
                               Text="Drag and drop audio file here or click Browse..."
                               Foreground="{StaticResource TextSecondaryBrush}"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis"/>
                </Border>

                <Button Grid.Row="1" Grid.Column="1"
                        Content="ðŸ“‚ Browse"
                        Style="{StaticResource SecondaryButton}"
                        Click="BrowseButton_Click"
                        Margin="0,0,10,0"/>

                <Button Grid.Row="1" Grid.Column="2"
                        Content="âŒ Clear"
                        Style="{StaticResource SecondaryButton}"
                        Click="ClearButton_Click"/>
            </Grid>
        </Border>

        <!-- Audio Info Panel -->
        <Border Grid.Row="2"
                x:Name="AudioInfoPanel"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="8"
                Padding="20"
                Margin="0,0,0,15"
                Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="Audio Information"
                           Foreground="{StaticResource PrimaryBrush}"
                           FontWeight="SemiBold"
                           FontSize="14"
                           Margin="0,0,0,10"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Duration" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock x:Name="DurationText" Text="--:--" Foreground="{StaticResource TextBrush}" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="Sample Rate" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock x:Name="SampleRateText" Text="-- Hz" Foreground="{StaticResource TextBrush}" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Channels" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock x:Name="ChannelsText" Text="--" Foreground="{StaticResource TextBrush}" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                    <StackPanel Grid.Column="3">
                        <TextBlock Text="Bit Depth" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11"/>
                        <TextBlock x:Name="BitDepthText" Text="-- bit" Foreground="{StaticResource TextBrush}" FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Options -->
        <Border Grid.Row="3"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="8"
                Padding="20"
                Margin="0,0,0,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.ColumnSpan="3"
                           Text="Separation Options"
                           Foreground="{StaticResource PrimaryBrush}"
                           FontWeight="SemiBold"
                           FontSize="14"
                           Margin="0,0,0,15"/>

                <!-- Model Selection -->
                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,15,0">
                    <TextBlock Text="Model"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="12"
                               Margin="0,0,0,5"/>
                    <ComboBox x:Name="ModelComboBox" SelectedIndex="0">
                        <ComboBoxItem Content="htdemucs_6s (6 stems - Recommended)" Tag="htdemucs_6s"/>
                        <ComboBoxItem Content="htdemucs (4 stems - Faster)" Tag="htdemucs"/>
                        <ComboBoxItem Content="htdemucs_ft (4 stems - Better vocals)" Tag="htdemucs_ft"/>
                    </ComboBox>
                </StackPanel>

                <!-- Output Format -->
                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,15,0">
                    <TextBlock Text="Output Format"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="12"
                               Margin="0,0,0,5"/>
                    <ComboBox x:Name="FormatComboBox" SelectedIndex="0">
                        <ComboBoxItem Content="WAV (Lossless)" Tag="wav"/>
                        <ComboBoxItem Content="MP3 (Compressed)" Tag="mp3"/>
                    </ComboBox>
                </StackPanel>

                <!-- Quality -->
                <StackPanel Grid.Row="1" Grid.Column="2">
                    <TextBlock Text="Quality (Shifts)"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="12"
                               Margin="0,0,0,5"/>
                    <ComboBox x:Name="ShiftsComboBox" SelectedIndex="1">
                        <ComboBoxItem Content="Fast (0 shifts)" Tag="0"/>
                        <ComboBoxItem Content="Balanced (1 shift)" Tag="1"/>
                        <ComboBoxItem Content="High (2 shifts)" Tag="2"/>
                        <ComboBoxItem Content="Best (5 shifts)" Tag="5"/>
                    </ComboBox>
                </StackPanel>

                <!-- Additional Options -->
                <StackPanel Grid.Row="2" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,15,0,0">
                    <CheckBox x:Name="CpuOnlyCheckBox"
                              Content="CPU Only (No GPU)"
                              Margin="0,0,30,0"/>
                    <Button Content="ðŸ“ Output Folder..."
                            Style="{StaticResource SecondaryButton}"
                            Padding="15,8"
                            FontSize="12"
                            Click="OutputFolderButton_Click"/>
                    <TextBlock x:Name="OutputFolderText"
                               Text="(Same as input file)"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               VerticalAlignment="Center"
                               Margin="10,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Progress and Log -->
        <Border Grid.Row="4"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="8"
                Padding="20"
                Margin="0,0,0,15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Progress"
                           Foreground="{StaticResource PrimaryBrush}"
                           FontWeight="SemiBold"
                           FontSize="14"
                           Margin="0,0,0,10"/>

                <!-- Overall Progress -->
                <Grid Grid.Row="1" Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="50"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Overall:"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="12"
                               VerticalAlignment="Center"/>
                    <ProgressBar x:Name="ProgressBar"
                                 Grid.Column="1"
                                 Height="8"
                                 Value="0"
                                 Maximum="100"
                                 Background="#1A1A1A"
                                 Foreground="{StaticResource PrimaryBrush}"
                                 Margin="10,0"/>
                    <TextBlock x:Name="OverallPercentText"
                               Grid.Column="2"
                               Text="0%"
                               Foreground="{StaticResource TextBrush}"
                               FontSize="12"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right"/>
                </Grid>

                <!-- Current Stem Progress -->
                <Grid Grid.Row="2" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="50"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock x:Name="CurrentStemLabel"
                               Text="Ready"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="12"
                               VerticalAlignment="Center"/>
                    <ProgressBar x:Name="StemProgressBar"
                                 Grid.Column="1"
                                 Height="8"
                                 Value="0"
                                 Maximum="100"
                                 Background="#1A1A1A"
                                 Foreground="{StaticResource AccentBrush}"
                                 Margin="10,0"/>
                    <TextBlock x:Name="StemPercentText"
                               Grid.Column="2"
                               Text=""
                               Foreground="{StaticResource TextBrush}"
                               FontSize="12"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right"/>
                </Grid>

                <Border Grid.Row="3"
                        Background="#1A1A1A"
                        CornerRadius="4"
                        Padding="10">
                    <ScrollViewer x:Name="LogScrollViewer" VerticalScrollBarVisibility="Auto">
                        <TextBlock x:Name="LogText"
                                   Text="Ready. Select an audio file to begin."
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontFamily="Consolas"
                                   FontSize="12"
                                   TextWrapping="Wrap"/>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Border>

        <!-- Action Buttons -->
        <Grid Grid.Row="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock x:Name="StatusText"
                           Text="Ready"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           VerticalAlignment="Center"/>
            </StackPanel>

            <Button Grid.Column="1"
                    x:Name="OpenOutputButton"
                    Content="ðŸ“‚ Open Output Folder"
                    Style="{StaticResource SecondaryButton}"
                    Click="OpenOutputButton_Click"
                    Visibility="Collapsed"
                    Margin="0,0,10,0"/>

            <Button Grid.Column="2"
                    x:Name="SeparateButton"
                    Content="ðŸŽ›ï¸ Separate Stems"
                    Style="{StaticResource PrimaryButton}"
                    Click="SeparateButton_Click"
                    IsEnabled="False"
                    Padding="30,12"/>
        </Grid>
    </Grid>
</Window>
